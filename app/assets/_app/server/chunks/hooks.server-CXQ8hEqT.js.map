{"version":3,"file":"hooks.server-CXQ8hEqT.js","sources":["../../../.svelte-kit/adapter-node/chunks/hooks.server.js"],"sourcesContent":["import { e as env } from \"./env.js\";\nimport fs from \"fs\";\nconst jsonFilePath = \"./src/lib/data/redirects.json\";\nfunction readRedirectsFromFile(filePath) {\n  try {\n    const data = fs.readFileSync(filePath, \"utf8\");\n    const redirects2 = JSON.parse(data);\n    return redirects2;\n  } catch (error) {\n    console.error(\"Error reading JSON file:\", error);\n    return [];\n  }\n}\nconst redirects = readRedirectsFromFile(jsonFilePath);\nlet delayAmount = 1200;\nconst handleFetch = async ({ event, request, fetch }) => {\n  let logStart = `(${env})${(/* @__PURE__ */ new Date()).toLocaleString()}`;\n  let pathName = new URL(request.url).pathname;\n  console.info(\n    `${logStart}: ${event.url.pathname} >> ${request.method} ${pathName}`\n  );\n  try {\n    await delay(delayAmount);\n    return fetch(request);\n  } catch (error) {\n    console.error(\n      `${logStart} >> Error: ${event.url.pathname} >> ${error.status}: ${pathName}`\n    );\n    console.error(\"Fetch error:\", error);\n    return new Response(error, { status: error.status });\n  }\n};\nconst handle = async ({ event, resolve }) => {\n  const redirect = redirects.find((item) => event.url.pathname === item.source);\n  if (redirect)\n    return new Response(\"\", {\n      status: 301,\n      headers: { Location: redirect.destination }\n    });\n  return await resolve(event);\n};\nfunction delay(ms) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\nexport {\n  handle,\n  handleFetch\n};\n"],"names":[],"mappings":";;;AAEA,MAAM,YAAY,GAAG,+BAA+B,CAAC;AACrD,SAAS,qBAAqB,CAAC,QAAQ,EAAE;AACzC,EAAE,IAAI;AACN,IAAI,MAAM,IAAI,GAAG,EAAE,CAAC,YAAY,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;AACnD,IAAI,MAAM,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;AACxC,IAAI,OAAO,UAAU,CAAC;AACtB,GAAG,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,OAAO,CAAC,KAAK,CAAC,0BAA0B,EAAE,KAAK,CAAC,CAAC;AACrD,IAAI,OAAO,EAAE,CAAC;AACd,GAAG;AACH,CAAC;AACD,MAAM,SAAS,GAAG,qBAAqB,CAAC,YAAY,CAAC,CAAC;AACtD,IAAI,WAAW,GAAG,IAAI,CAAC;AAClB,MAAC,WAAW,GAAG,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK;AACzD,EAAE,IAAI,QAAQ,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE,iBAAiB,IAAI,IAAI,EAAE,EAAE,cAAc,EAAE,CAAC,CAAC,CAAC;AAC5E,EAAE,IAAI,QAAQ,GAAG,IAAI,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC;AAC/C,EAAE,OAAO,CAAC,IAAI;AACd,IAAI,CAAC,EAAE,QAAQ,CAAC,EAAE,EAAE,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;AACzE,GAAG,CAAC;AACJ,EAAE,IAAI;AACN,IAAI,MAAM,KAAK,CAAC,WAAW,CAAC,CAAC;AAC7B,IAAI,OAAO,KAAK,CAAC,OAAO,CAAC,CAAC;AAC1B,GAAG,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,OAAO,CAAC,KAAK;AACjB,MAAM,CAAC,EAAE,QAAQ,CAAC,WAAW,EAAE,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,MAAM,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;AACnF,KAAK,CAAC;AACN,IAAI,OAAO,CAAC,KAAK,CAAC,cAAc,EAAE,KAAK,CAAC,CAAC;AACzC,IAAI,OAAO,IAAI,QAAQ,CAAC,KAAK,EAAE,EAAE,MAAM,EAAE,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC;AACzD,GAAG;AACH,EAAE;AACG,MAAC,MAAM,GAAG,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK;AAC7C,EAAE,MAAM,QAAQ,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK,KAAK,CAAC,GAAG,CAAC,QAAQ,KAAK,IAAI,CAAC,MAAM,CAAC,CAAC;AAChF,EAAE,IAAI,QAAQ;AACd,IAAI,OAAO,IAAI,QAAQ,CAAC,EAAE,EAAE;AAC5B,MAAM,MAAM,EAAE,GAAG;AACjB,MAAM,OAAO,EAAE,EAAE,QAAQ,EAAE,QAAQ,CAAC,WAAW,EAAE;AACjD,KAAK,CAAC,CAAC;AACP,EAAE,OAAO,MAAM,OAAO,CAAC,KAAK,CAAC,CAAC;AAC9B,EAAE;AACF,SAAS,KAAK,CAAC,EAAE,EAAE;AACnB,EAAE,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,KAAK,UAAU,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC,CAAC;AAC3D;;;;"}